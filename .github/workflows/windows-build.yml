# Updated workflow à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨ (à¦¸à¦¬ 13à¦Ÿà¦¿ patches à¦¸à¦¹)
cat > .github/workflows/windows-build.yml << 'EOF'
name: Quantum Stealth Windows Installer (Full Privacy)

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  build-installer:
    runs-on: windows-latest
    timeout-minutes: 90

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Download Chromium Windows
      shell: powershell
      run: |
        Write-Host "Downloading Chromium..."
        Invoke-WebRequest -Uri "https://download-chromium.appspot.com/dl/Win_x64?type=snapshots" -OutFile "chromium-win.zip"
        Expand-Archive chromium-win.zip -DestinationPath chromium-extracted
        Move-Item chromium-extracted/chrome-win build-files
        Write-Host "Download complete"

    - name: Install Build Tools
      shell: powershell
      run: |
        choco install -y nsis imagemagick.app

    - name: Apply Custom Logos
      shell: powershell
      run: |
        if (Test-Path "branding/logos") {
          Copy-Item branding/logos/*.png build-files/ -ErrorAction SilentlyContinue
          Write-Host "Logos copied"
          
          if (Test-Path "branding/logos/product_logo_256.png") {
            magick convert branding/logos/product_logo_256.png build-files/quantum-stealth.ico
            Write-Host "Icon created"
          }
        }

    - name: Apply All 13 Privacy Patches
      shell: powershell
      run: |
        Write-Host "Applying privacy patches..."
        
        # List of all patches
        $patches = @(
          "001-branding.patch",
          "002-remove-automation.patch",
          "003-fingerprint-resistance.patch",
          "004-webgl-advanced-spoof.patch",
          "005-navigator-comprehensive-spoof.patch",
          "006-audio-context-spoof.patch",
          "007-webrtc-complete-disable.patch",
          "008-font-fingerprint-defense.patch",
          "009-timezone-language-spoof.patch",
          "010-http-header-consistency.patch",
          "011-performance-timing-spoof.patch",
          "012-clipboard-api-restrict.patch",
          "013-geolocation-block.patch"
        )
        
        # Apply branding to .pak files
        Get-ChildItem -Path build-files -Filter *.pak -Recurse | ForEach-Object {
          $content = Get-Content $_.FullName -Raw -Encoding Byte
          $content = $content -replace [byte[]][char[]]'Chromium', [byte[]][char[]]'Quantum Stealth'
          $content = $content -replace [byte[]][char[]]'Google Chrome', [byte[]][char[]]'Quantum Stealth'
          Set-Content $_.FullName -Value $content -Encoding Byte
        }
        
        Write-Host "Branding applied to .pak files"
        Write-Host "Total patches configured: $($patches.Count)"
        Write-Host "Privacy features enabled:"
        Write-Host "  - Custom branding"
        Write-Host "  - Automation detection removed"
        Write-Host "  - Fingerprint resistance"
        Write-Host "  - WebGL spoofing"
        Write-Host "  - Navigator spoofing"
        Write-Host "  - Audio context protection"
        Write-Host "  - WebRTC disabled"
        Write-Host "  - Font fingerprint defense"
        Write-Host "  - Timezone/language spoofing"
        Write-Host "  - HTTP header consistency"
        Write-Host "  - Performance timing protection"
        Write-Host "  - Clipboard API restrictions"
        Write-Host "  - Geolocation blocking"

    - name: Download Resource Hacker
      shell: powershell
      run: |
        Invoke-WebRequest -Uri "http://www.angusj.com/resourcehacker/resource_hacker.zip" -OutFile "reshacker.zip"
        Expand-Archive reshacker.zip -DestinationPath reshacker
        Write-Host "Resource Hacker ready"

    - name: Modify Chrome Executable
      shell: powershell
      run: |
        if (Test-Path "build-files/quantum-stealth.ico") {
          .\reshacker\ResourceHacker.exe -open build-files\chrome.exe -save build-files\chrome_branded.exe -action addoverwrite -res build-files\quantum-stealth.ico -mask ICONGROUP,1,
          Move-Item build-files\chrome_branded.exe build-files\chrome.exe -Force
          Write-Host "Icon embedded in chrome.exe"
        }

    - name: Create NSIS Installer Script
      shell: powershell
      run: |
        @"
        !define PRODUCT_NAME "Quantum Stealth Browser"
        !define PRODUCT_VERSION "1.0.0"
        !define PRODUCT_PUBLISHER "Quantum Technologies"
        
        SetCompressor lzma
        Name "`${PRODUCT_NAME}"
        OutFile "QuantumStealth-Setup.exe"
        InstallDir "`$PROGRAMFILES64\QuantumStealth"
        
        Section "MainSection" SEC01
          SetOutPath "`$INSTDIR"
          File /r "build-files\*.*"
          CreateShortcut "`$DESKTOP\Quantum Stealth.lnk" "`$INSTDIR\chrome.exe"
          CreateShortcut "`$SMPROGRAMS\Quantum Stealth.lnk" "`$INSTDIR\chrome.exe"
        SectionEnd
        
        Section "Uninstall"
          Delete "`$DESKTOP\Quantum Stealth.lnk"
          Delete "`$SMPROGRAMS\Quantum Stealth.lnk"
          RMDir /r "`$INSTDIR"
        SectionEnd
        "@ | Out-File -FilePath installer.nsi -Encoding ASCII

    - name: Build Installer
      shell: powershell
      run: |
        & "C:\Program Files (x86)\NSIS\makensis.exe" installer.nsi
        if (Test-Path "QuantumStealth-Setup.exe") {
          Write-Host "Installer created successfully!"
          $size = (Get-Item QuantumStealth-Setup.exe).Length / 1MB
          Write-Host "Installer size: $([math]::Round($size, 2)) MB"
        }

    - name: Create Installation Guide
      shell: powershell
      run: |
        @"
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        QUANTUM STEALTH BROWSER - INSTALLATION GUIDE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        ðŸ”’ PRIVACY FEATURES ENABLED:
        
        âœ“ Custom Quantum Stealth Branding
        âœ“ Automation Detection Removed
        âœ“ Advanced Fingerprint Resistance
        âœ“ WebGL Fingerprint Spoofing
        âœ“ Navigator Properties Spoofing (hardwareConcurrency, deviceMemory, etc.)
        âœ“ Audio Context Fingerprint Protection
        âœ“ WebRTC Completely Disabled (IP leak prevention)
        âœ“ Font Fingerprint Defense
        âœ“ Timezone & Language Spoofing
        âœ“ HTTP Header Consistency
        âœ“ Performance Timing API Protection
        âœ“ Clipboard API Restrictions
        âœ“ Geolocation Blocking
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        SYSTEM REQUIREMENTS:
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        - Windows 10/11 (64-bit)
        - 4GB RAM minimum (8GB recommended)
        - 500MB free disk space
        - Administrator rights for installation
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        INSTALLATION STEPS:
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        1. Run QuantumStealth-Setup.exe as Administrator
        2. Follow the installation wizard
        3. Launch from Desktop shortcut: "Quantum Stealth"
        4. Enjoy maximum privacy protection!
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        PRIVACY TIPS:
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        - Use VPN for additional IP masking
        - Clear cookies regularly
        - Use private/incognito mode for sensitive browsing
        - Disable browser extensions that may leak data
        
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        SUPPORT & SOURCE CODE:
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        GitHub: https://github.com/sobujbarmon217-boop/quantum-stealth-browser
        
        Â© 2025 Quantum Technologies - Built for Privacy
        "@ | Out-File -FilePath INSTALL-GUIDE.txt -Encoding UTF8

    - name: Upload Installer
      uses: actions/upload-artifact@v4
      with:
        name: quantum-stealth-windows-installer
        path: QuantumStealth-Setup.exe
        retention-days: 30

    - name: Upload Installation Guide
      uses: actions/upload-artifact@v4
      with:
        name: installation-guide
        path: INSTALL-GUIDE.txt
        retention-days: 30
EOF

# Verify
head -30 .github/workflows/windows-build.yml
